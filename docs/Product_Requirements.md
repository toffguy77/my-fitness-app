# Требования к продукту My Fitness App

**Версия документа:** 1.0  
**Дата создания:** Январь 2025  
**Статус:** Актуальная реализация v4.0+

---

## Обзор

Этот документ описывает функциональные и нефункциональные требования к My Fitness App, включая приоритизацию функций и roadmap развития.

---

## Функциональные требования

### По ролям пользователей

#### Для клиентов (Client)

##### Free уровень
- ✅ Регистрация и авторизация
- ✅ Онбординг с расчетом целей питания
- ✅ Ввод данных о питании (КБЖУ)
- ✅ Множественные приемы пищи
- ✅ Отслеживание веса тела
- ✅ Просмотр дашборда с сводкой за неделю
- ✅ Блокировка редактирования завершенных дней
- ✅ Валидация данных о питании

##### Premium уровень
- ✅ Работа с тренером (получение заметок и обратной связи)
- ✅ Чат с тренером в реальном времени (WebSocket)
- ✅ Доступ к отчетам и аналитике
- ✅ Графики веса и КБЖУ
- ✅ Экспорт данных (CSV, JSON, PDF)
- ✅ Фильтры и пагинация в отчетах
- ✅ Система достижений и бейджей
- ✅ OCR распознавание этикеток продуктов
- ✅ База продуктов с автозаполнением

#### Для тренеров (Coach)
- ✅ Кабинет тренера с списком клиентов
- ✅ Traffic Light System v2 для приоритизации работы
- ✅ Просмотр дашборда клиента
- ✅ Редактирование целей питания клиента
- ✅ Сохранение заметок для клиента по датам
- ✅ Чат с клиентами в реальном времени
- ✅ Умная отправка уведомлений (проверка настроек клиента)
- ✅ Генерация инвайт-кодов для привлечения клиентов
- ✅ Статистика использования инвайт-кодов

#### Для супер-администраторов (Super Admin)
- ✅ Управление пользователями
- ✅ Назначение и изменение ролей
- ✅ Управление подписками
- ✅ Назначение тренеров клиентам
- ✅ Просмотр всех данных системы

---

## Нефункциональные требования

### Производительность
- Время загрузки страниц: < 2 секунды
- Время ответа API: < 500ms
- Время выполнения запросов к БД: < 200ms
- Оптимистичные обновления UI для лучшей воспринимаемой производительности

### Масштабируемость
- Поддержка до 10,000 активных пользователей
- Горизонтальное масштабирование через Docker
- Автоматическое масштабирование БД через Supabase

### Безопасность
- Row Level Security (RLS) для защиты данных
- Middleware для защиты маршрутов
- Валидация данных на клиенте и сервере
- HTTPS для всех соединений
- JWT токены для авторизации

### Надежность
- Uptime: 99.9%
- Обработка ошибок с понятными сообщениями
- Graceful degradation при сбоях внешних сервисов
- Автоматическое резервное копирование БД (Supabase)

### Удобство использования (UX)
- Интуитивный интерфейс
- Адаптивный дизайн (mobile-first)
- Toast уведомления вместо alert()
- Loading индикаторы для всех асинхронных операций
- Визуальная обратная связь при всех действиях

### Совместимость
- Поддержка современных браузеров (Chrome, Firefox, Safari, Edge)
- PWA для мобильных устройств
- Работа на iOS и Android через браузер

### Доступность
- Семантический HTML
- ARIA атрибуты где необходимо
- Контрастность цветов (WCAG AA)

---

## Ограничения и зависимости

### Технические ограничения
- Зависимость от Supabase для БД и Auth
- Зависимость от внешних API (Resend, Open Food Facts, OpenRouter)
- Ограничения бесплатного плана Supabase (при масштабировании)

### Бизнес-ограничения
- Ручное управление подписками (нет интеграции платежей)
- Нет автоматического продления подписок
- Ограниченная аналитика для тренеров

### Функциональные ограничения
- Нет мобильных приложений (только PWA)
- Нет интеграции с фитнес-трекерами
- Нет планирования меню
- Нет социальных функций (публичные профили, лидерборды)

---

## Приоритизация функций

### Критичные (P0)
- ✅ Авторизация и регистрация
- ✅ Ввод данных о питании
- ✅ Дашборд клиента
- ✅ Онбординг с расчетом целей
- ✅ Защита маршрутов (middleware)
- ✅ Безопасность данных (RLS)

### Высокий приоритет (P1)
- ✅ Работа с тренером (заметки, обратная связь)
- ✅ Кабинет тренера
- ✅ Traffic Light System
- ✅ Валидация данных
- ✅ Система уведомлений
- ✅ Автоматическая деактивация подписок

### Средний приоритет (P2)
- ✅ Чат с тренером
- ✅ База продуктов
- ✅ OCR распознавание
- ✅ Графики и аналитика
- ✅ Экспорт данных
- ✅ Система достижений
- ✅ PWA поддержка
- ✅ Инвайт-коды

### Низкий приоритет (P3)
- ⚠️ Экспорт PDF (опционально)
- ⚠️ Отправка файлов в чате
- ⚠️ Избранные продукты
- ⚠️ Push-уведомления
- ⚠️ Публичные профили
- ⚠️ Лидерборды

---

## Roadmap

### Phase 1: MVP - Цифровой дневник питания ✅
**Статус:** Реализовано

- Базовая авторизация и регистрация
- Ввод данных о питании (КБЖУ)
- Дашборд с сводкой за неделю
- Установка целей питания
- Отслеживание веса тела

### Phase 2: The Loop - Петля обратной связи ✅
**Статус:** Реализовано

- Кабинет тренера
- Traffic Light System
- Система заметок тренера
- Daily Check-in
- Просмотр дашборда клиента тренером

### Phase 2.5: Freemium SaaS ✅
**Статус:** Реализовано

- Модель подписок (Free/Premium)
- Роли пользователей
- Paywall для Premium функций
- Управление подписками

### Phase 2.6: Enhanced Dashboard ✅
**Статус:** Реализовано

- Улучшенный дашборд клиента
- Множественные приемы пищи
- Умное копирование приемов пищи
- Навигация по датам

### Phase 3: Уведомления и валидация ✅
**Статус:** Реализовано

- Система уведомлений (email через Resend)
- Валидация данных о питании
- Автоматическая деактивация подписок
- Настройки уведомлений

### Phase 3.1: Onboarding ✅
**Статус:** Реализовано

- Мастер настройки
- Автоматический расчет BMR/TDEE
- Создание целей питания

### Phase 3.2: Feedback Loop ✅
**Статус:** Реализовано

- Улучшенная петля обратной связи
- Daily Check-in с блокировкой
- Пересчет целей питания

### Phase 3.3: Валидация и уведомления ✅
**Статус:** Реализовано

- Серверная валидация данных
- Система уведомлений через Edge Functions
- Автоматическая деактивация подписок

### Phase 3.4: Reliability & Safety ✅
**Статус:** Реализовано

- Subscription Lifecycle UI
- Notification Preferences
- Coach Input Guardrails

### Phase 4: UX Improvements & Data Visualization ✅
**Статус:** Реализовано (100%)

- Toast уведомления
- Loading индикаторы
- ProgressBar компоненты
- Графики веса и КБЖУ
- Экспорт данных
- Фильтры и пагинация
- Оптимистичные обновления

### Phase 5: Коммуникация и база продуктов ✅
**Статус:** Реализовано (95%)

- Чат с тренером (WebSocket)
- База продуктов с автозаполнением
- Интеграция с Open Food Facts API
- Пользовательские продукты
- История использования продуктов

**Реализовано:**
- Избранные продукты ✅

### Phase 6: PWA и инвайт-система ✅
**Статус:** Реализовано (90%)

- Progressive Web App
- Service Worker для offline режима
- Установка на домашний экран
- Инвайт-коды для тренеров
- Автоматическое назначение тренера

**Осталось:**
- Push-уведомления (низкий приоритет)

### Phase 7: OCR и расширенная функциональность ✅
**Статус:** Реализовано (85%)

- OCR распознавание этикеток
- Гибридный подход (Tesseract.js + OpenRouter)
- Система достижений и бейджей
- Публикация прогресса в соцсетях

**Реализовано:**
- Публичные профили ✅
- Лидерборды ✅

---

## Метрики успеха

### Пользовательские метрики
- Количество активных пользователей (DAU, MAU)
- Retention rate (удержание пользователей)
- Частота использования (дни с данными)
- Среднее количество приемов пищи в день
- Конверсия Free → Premium

### Бизнес-метрики
- MRR (Monthly Recurring Revenue)
- Churn rate (отток пользователей)
- LTV (Lifetime Value)
- CAC (Customer Acquisition Cost)
- LTV/CAC Ratio

### Технические метрики
- Время загрузки страниц
- Производительность запросов к БД
- Доступность сервиса (uptime)
- Ошибки и их частота
- Время ответа API

---

## Будущее развитие

### Планируемые улучшения
- Интеграция платежей (Stripe, ЮKassa)
- Автоматическое продление подписок
- Расширенная аналитика для тренеров
- Интеграция с фитнес-трекерами
- Мобильные приложения (iOS/Android)
- Социальные функции
- AI-рекомендации по питанию

### Исследования
- Автоматическое планирование меню
- Интеграция с доставкой еды
- Геймификация для повышения вовлеченности
- Персонализация на основе данных

---

## Связанные документы

- [Functional_Specification.md](./Functional_Specification.md) - Функциональная спецификация
- [Business_Model.md](./Business_Model.md) - Бизнес-модель
- [Technical_Architecture.md](./Technical_Architecture.md) - Техническая архитектура
- [Phase4-7_Roadmap.md](../Phase4-7_Roadmap.md) - Долгосрочный план развития

---

**Последнее обновление:** Январь 2025  
**Версия документа:** 1.0
