# –ê–Ω–∞–ª–∏–∑ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π –∏ –Ω–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-01-20  
**–í–µ—Ä—Å–∏—è:** 1.0

---

## –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è:
1. –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π –º–µ–∂–¥—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π
2. –ù–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
3. –ò–∑–≤–µ—Å—Ç–Ω—ã—Ö –±–∞–≥–æ–≤ –∏ –ø—Ä–æ–±–ª–µ–º
4. –ü–ª–∞–Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∏ –¥–æ—Ä–∞–±–æ—Ç–æ–∫

---

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ß–∞—Ç: —Ç—Ä–µ–Ω–µ—Ä –Ω–µ –≤–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢—Ä–µ–Ω–µ—Ä –Ω–µ –≤–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —á–∞—Ç–∞.

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ RLS –ø–æ–ª–∏—Ç–∏–∫–∞ "Users can read their own messages" –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞: `(auth.uid() = sender_id OR auth.uid() = receiver_id)`
- ‚úÖ –õ–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ `ChatWindow` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞: –¥–≤–∞ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã
- ‚ùå **–ù–ê–ô–î–ï–ù–ê –ü–†–û–ë–õ–ï–ú–ê:** –í `src/utils/chat/realtime.ts` —Å—Ç—Ä–æ–∫–∞ 78 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞–ø—è—Ç—É—é –≤ —Ñ–∏–ª—å—Ç—Ä–µ: `filter: \`sender_id=eq.${otherUserId},receiver_id=eq.${userId}\``

**–ü—Ä–æ–±–ª–µ–º–∞:**
–í Supabase Realtime —Ñ–∏–ª—å—Ç—Ä—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.and.` –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —É—Å–ª–æ–≤–∏–π, –∞ –Ω–µ –∑–∞–ø—è—Ç—É—é. –¢–µ–∫—É—â–∏–π —Ñ–æ—Ä–º–∞—Ç `sender_id=eq.${otherUserId},receiver_id=eq.${userId}` –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
–ò–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –Ω–∞: `filter: \`sender_id=eq.${otherUserId}.and.receiver_id=eq.${userId}\``

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- –õ–æ–≥–∏–∫—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ `MessageList`
- –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–æ–æ–±—â–µ–Ω–∏–π

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π

---

### 4. –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã

**–°—Ç–∞—Ç—É—Å:** –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –í Product_Requirements.md —É–∫–∞–∑–∞–Ω–æ –∫–∞–∫ –Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (P3)
- –ë–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞, –Ω–æ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –Ω–µ—Ç

**–¢—Ä–µ–±—É–µ—Ç—Å—è:**
- –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `favorite_products` –∏–ª–∏ –ø–æ–ª–µ –≤ `user_products`
- UI –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- –§–∏–ª—å—Ç—Ä –ø–æ –∏–∑–±—Ä–∞–Ω–Ω—ã–º –ø—Ä–æ–¥—É–∫—Ç–∞–º

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–∏–∑–∫–∏–π

---

## –ü—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π

### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø–∏—Ç–∞–Ω–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –í–æ–∑–º–æ–∂–Ω—ã –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –∏ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π

**–¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ `src/utils/validation/nutrition.ts` –∏ CHECK constraints –≤ –ë–î
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π

---

## –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üî¥)

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å —á–∞—Ç–æ–º –¥–ª—è —Ç—Ä–µ–Ω–µ—Ä–æ–≤**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç —Ñ–∏–ª—å—Ç—Ä–∞ –≤ realtime –ø–æ–¥–ø–∏—Å–∫–µ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.and.` –≤–º–µ—Å—Ç–æ –∑–∞–ø—è—Ç–æ–π)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ `ChatWindow`
   - –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å realtime –ø–æ–¥–ø–∏—Å–∫–∏
   - **–û—Ü–µ–Ω–∫–∞:** 2-4 —á–∞—Å–∞
   - **–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
     - `src/utils/chat/realtime.ts` (—Å—Ç—Ä–æ–∫–∞ 78: —Ñ–∏–ª—å—Ç—Ä realtime)
     - `src/components/chat/ChatWindow.tsx` (–ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏)

### –§–∞–∑–∞ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É–ª—É—á—à–µ–Ω–∏—è (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü°)

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç PDF**
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç PDF —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
   - –ï—Å–ª–∏ –Ω–µ—Ç - —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å
   - **–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö**
   - –°–≤–µ—Ä–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é –∏ —Å–µ—Ä–≤–µ—Ä–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é
   - –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
   - **–û—Ü–µ–Ω–∫–∞:** 1-2 —á–∞—Å–∞

### –§–∞–∑–∞ 3: –ù–∏–∑–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: üü¢)

5. **–ò–∑–±—Ä–∞–Ω–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã**
   - –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É/–ø–æ–ª–µ
   - UI –¥–ª—è –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
   - **–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

6. **–ü—É–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏**
   - –°–æ–∑–¥–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
   - **–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

7. **–õ–∏–¥–µ—Ä–±–æ—Ä–¥—ã**
   - –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–æ–≤
   - **–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞
